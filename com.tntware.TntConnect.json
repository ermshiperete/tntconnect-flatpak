{
  "app-id": "com.tntware.TntConnect",
  "branch": "master",
  "runtime": "org.freedesktop.Platform/i386",
  "sdk": "org.freedesktop.Sdk/i386",
  "runtime-version": "1.6",
  "tags": [
    "proprietary"
  ],
  "command": "tntconnect.sh",
  "build-options": {
    "cflags": "-O1 -pipe",
    "env": {
      "V": "0"
    }
  },
  "finish-args": [
    "--socket=x11",
    "--share=network",
    "--share=ipc",
    "--device=dri",
    "--allow=multiarch",
    "--socket=pulseaudio",
    "--filesystem=/var/log:ro",
    "--filesystem=xdg-documents",
    "--filesystem=host",
    "--filesystem=home",
    "--filesystem=/tmp",
    "--env=WINEDEBUG=-all",
    "--socket=system-bus",
    "--socket=session-bus",
    "--talk-name=org.freedesktop.secrets",
    "--talk-name=org.freedesktop.portal.Documents",
    "--system-talk-name=org.freedesktop.secrets",
    "--system-talk-name=org.freedesktop.portal.Documents",
    "--talk-name=org.freedesktop.portal.desktop",
    "--system-talk-name=org.freedesktop.portal.desktop",
    "--device=all",
    "--filesystem=xdg-run/dconf",
    "--filesystem=~/.config/dconf:ro",
    "--talk-name=ca.desrt.dconf",
    "--env=DCONF_USER_CONFIG_DIR=.config/dconf"
  ],
  "modules": [
    {
      "name": "dpkg",
      "buildsystem": "autotools",
      "sources": [
        {
          "type": "archive",
          "url": "http://archive.ubuntu.com/ubuntu/pool/main/d/dpkg/dpkg_1.19.0.5ubuntu2.tar.xz",
          "sha256": "29444a09e6976e9b9adde799acd78d7049bf5c933f4d49b249a11f167d79d5f4"
        }
      ]
    },
    {
      "name": "wine",
      "buildsystem": "simple",
      "build-options": {
        "make-args": [
          "--silent"
        ]
      },
      "cleanup": [
        "/bin/function_grep.pl",
        "/bin/msiexec",
        "/bin/widl",
        "/bin/wine64-preloader",
        "/bin/winebuild",
        "/bin/wineconsole",
        "/bin/winedbg",
        "/bin/winefile",
        "/bin/winegcc",
        "/bin/winemine",
        "/bin/wrc",
        "/bin/msidb",
        "/bin/notepad",
        "/bin/regsvr32",
        "/bin/wineboot",
        "/bin/winecfg",
        "/bin/winecpp",
        "/bin/winedump",
        "/bin/wineg++",
        "/bin/winemaker",
        "/bin/winepath",
        "/bin/wmc",
        "/include",
        "/share/man",
        "/share/applications",
        "/bin/dpkg*"
      ],
      "build-commands": [
        "dpkg -x wine-devel-i386_3.20.0~xenial_i386.deb /tmp/wine-devel && dpkg -x wine-devel_3.20.0~xenial_i386.deb /tmp/wine-devel && rm -rf /tmp/wine-devel/opt/wine-devel/share/applications && rm -rf /tmp/wine-devel/opt/wine-devel/share/man && cp -a /tmp/wine-devel/opt/wine-devel/* /app/",
        "dpkg -x libudev1_229-4ubuntu21.9_i386.deb /tmp/wine-devel && cp -a /tmp/wine-devel/lib/i386-linux-gnu/* /app/lib/"
      ],
      "sources": [
        {
          "type": "file",
          "url": "https://dl.winehq.org/wine-builds/ubuntu/pool/main/wine-devel_3.20.0~xenial_i386.deb",
          "sha256": "cad4bd1ba0153119c597fa1bb60dbefd89e2d42c0bc662d29d0b9ce6e3be7668"
        },
        {
          "type": "file",
          "url": "https://dl.winehq.org/wine-builds/ubuntu/pool/main/wine-devel-i386_3.20.0~xenial_i386.deb",
          "sha256": "9fd62a90e0b4ece4d8d404cfce9b64681dec0cd86822b786586ee481c9a1687f"
        },
        {
          "type": "file",
          "url": "http://security.ubuntu.com/ubuntu/pool/main/s/systemd/libudev1_229-4ubuntu21.9_i386.deb",
          "sha256": "3c25e0d1cf4a6b812ec9e8ca4630ff3a239d8c87cc861a8a51b2dd3a02f87300"
        }
      ]
    },
    {
      "name": "winetricks",
      "buildsystem": "simple",
      "build-commands": [
        "make",
        "make PREFIX=/app install",
        "chmod +x /app/bin/winetricks"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://github.com/Winetricks/winetricks/archive/20180815.tar.gz",
          "sha256": "6dc22357ea1f857b7283250f7c6a68b9dee97e672bbea9a9c45c573d73634200"
        }
      ]
    },
    {
      "name": "cabextract",
      "buildsystem": "autotools",
      "sources": [
        {
          "type": "archive",
          "url": "https://www.cabextract.org.uk/cabextract-1.6.tar.gz",
          "sha256": "cee661b56555350d26943c5e127fc75dd290b7f75689d5ebc1f04957c4af55fb"
        }
      ]
    },
    {
      "name": "wine-gecko",
      "buildsystem": "simple",
      "build-commands": [
        "install -D wine_gecko-2.47-x86.msi /app/share/wine/gecko/wine_gecko-2.47-x86.msi"
      ],
      "no-make-install": true,
      "sources": [
        {
          "type": "file",
          "url": "http://dl.winehq.org/wine/wine-gecko/2.47/wine_gecko-2.47-x86.msi",
          "sha256": "3b8a361f5d63952d21caafd74e849a774994822fb96c5922b01d554f1677643a"
        }
      ]
    },
    {
      "name": "wine-mono",
      "buildsystem": "simple",
      "build-commands": [
        "install -D wine-mono-4.7.1.msi /app/share/wine/mono/wine-mono-4.7.1.msi"
      ],
      "no-make-install": true,
      "sources": [
        {
          "type": "file",
          "url": "http://dl.winehq.org/wine/wine-mono/4.7.1/wine-mono-4.7.1.msi",
          "sha256": "2c8d5db7f833c3413b2519991f5af1f433d59a927564ec6f38a3f1f8b2c629aa"
        }
      ]
    },
    {
      "name": "wget",
      "buildsystem": "autotools",
      "sources": [
        {
          "type": "archive",
          "url": "https://ftp.gnu.org/gnu/wget/wget-1.19.4.tar.gz",
          "sha256": "93fb96b0f48a20ff5be0d9d9d3c4a986b469cb853131f9d5fe4cc9cecbc8b5b5"
        }
      ]
    },
    {
      "name": "metadata",
      "buildsystem": "simple",
      "build-commands": [
        "install -Dm644 com.tntware.TntConnect.256x256.png /app/share/icons/hicolor/256x256/apps/com.tntware.TntConnect.png",
        "install -Dm644 com.tntware.TntConnect.128x128.png /app/share/icons/hicolor/128x128/apps/com.tntware.TntConnect.png",
        "install -Dm644 com.tntware.TntConnect.64x64.png /app/share/icons/hicolor/64x64/apps/com.tntware.TntConnect.png",
        "install -Dm644 com.tntware.TntConnect.48x48.png /app/share/icons/hicolor/48x48/apps/com.tntware.TntConnect.png",
        "install -Dm644 com.tntware.TntConnect.32x32.png /app/share/icons/hicolor/32x32/apps/com.tntware.TntConnect.png",
        "install -Dm644 com.tntware.TntConnect.16x16.png /app/share/icons/hicolor/16x16/apps/com.tntware.TntConnect.png",
        "install -D --mode=644 com.tntware.TntConnect.desktop /app/share/applications/com.tntware.TntConnect.desktop",
        "install -D --mode=644 com.tntware.TntConnect.appdata.xml /app/share/metainfo/com.tntware.TntConnect.appdata.xml"
      ],
      "no-make-install": true,
      "sources": [
        {
          "type": "file",
          "path": "icons/com.tntware.TntConnect.256x256.png"
        },
        {
          "type": "file",
          "path": "icons/com.tntware.TntConnect.128x128.png"
        },
        {
          "type": "file",
          "path": "icons/com.tntware.TntConnect.64x64.png"
        },
        {
          "type": "file",
          "path": "icons/com.tntware.TntConnect.48x48.png"
        },
        {
          "type": "file",
          "path": "icons/com.tntware.TntConnect.32x32.png"
        },
        {
          "type": "file",
          "path": "icons/com.tntware.TntConnect.16x16.png"
        },
        {
          "type": "file",
          "path": "com.tntware.TntConnect.desktop"
        },
        {
          "type": "file",
          "path": "com.tntware.TntConnect.appdata.xml"
        }
      ]
    },
    {
      "name": "tntconnect",
      "buildsystem": "simple",
      "build-commands": [
        "install -d /app/bin",
        "install tntconnect.sh /app/bin",
        "install -d /app/extra",
        "install TntConnect.tar.gz /app/extra",
        "cd /app/extra",
        "tar xfz TntConnect.tar.gz",
        "rm TntConnect.tar.gz",
        "cp -a wineprefix /app/extra",
        "rm -rf /app/extra/wineprefix/dosdevices/c",
        "ln -sf ../drive_c /app/extra/wineprefix/dosdevices/c:",
        "ln -sf / /app/extra/wineprefix/dosdevices/z:"
      ],
      "cleanup":[
        "/app/extra/TntConnect.tar.gz"
      ],
      "sources": [
        {
          "type": "file",
          "path": "TntConnect.tar.gz"
        },
        {
          "type": "file",
          "path": "tntconnect.sh"
        }
      ]
    }
  ]
}
